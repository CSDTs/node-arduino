<!DOCTYPE html>
<html>
    <head>
    	<meta charset = "utf-8"/>
        <title>Websocket test page</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
    </head>
    <body>
    	<canvas id="myChart" style="width:600px;height:250px;"></canvas>

    	<script>	
    		var socket = new WebSocket("ws://127.0.0.1:8080");
    		socket.onmessage = function(event) {
    			console.log(event.data);
    			if (event.data.length > 0) {
    				addData(chart, "", event.data);
    			}
    		}

			var ctx = document.getElementById('myChart').getContext('2d');
			var chart = new Chart(ctx, {
			    // The type of chart we want to create
			    type: 'line',

			    // The data for our dataset
			    data: {
			        labels: [],
			        datasets: [{
			        	label: 'Arduino Data',
			            borderColor: 'rgb(255, 99, 132)',
			            backgroundColor: 'rgb(255, 99, 132)',
			            data: [],
			            fill: false
			        }]
			    },

			    // Configuration options go here
			    options: {
			    	scales: {
			    		xAxes: [{
			    			gridLines: {
			    				display: false,
			    			}
			    		}]

			    		// yAxes: [{
			    		// 	gridLines: {
			    		// 		display: false,
			    		// 	}
			    		// }],
			    	}
			    }
			});

			function addData(chart, label, data) {
				chart.data.labels.push(label);
				chart.data.datasets.forEach( (dataset) => {
					dataset.data.push(data);
				});
				chart.update();
			}


		</script>

    </body>
</html>